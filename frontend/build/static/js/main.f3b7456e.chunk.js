(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{18:function(e,t,a){e.exports=a(42)},23:function(e,t,a){},42:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(15),l=a.n(s),i=(a(23),a(17)),c=a(2),o=a(3),u=a(5),m=a(4),p=function(e){return e.children},d=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e="failed";return"SUCCESS"===this.props.status?e="succeed":"RUNNING"!==this.props.status&&"CREATED"!==this.props.status||(e="running"),r.a.createElement("tr",{className:e},r.a.createElement("td",null,this.props.ID),r.a.createElement("td",null,this.props.requestedBy),r.a.createElement("td",null,this.props.createdAt),r.a.createElement("td",null,this.props.env_name),r.a.createElement("td",null,this.props.path),r.a.createElement("td",null,this.props.status),r.a.createElement("td",null,r.a.createElement("a",{href:"#",onClick:this.props.click},"View Details")))}}]),a}(n.Component),h=function(e){return e.items.map((function(t){return r.a.createElement(d,{key:t.id,ID:t.id,createdAt:t.created_at,env_name:t.env_name,requestedBy:t.requested_by,status:t.status,path:t.displayPath,click:e.clicked.bind(void 0,t.id)})}))},E=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=r.a.createElement(h,{items:this.props.items,clicked:this.props.viewItemDetails});return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("fieldset",null,r.a.createElement("legend",null,"Test execution requests"),r.a.createElement("div",{className:"table-responsive"},r.a.createElement("table",{className:"table table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Request ID"),r.a.createElement("th",null,"Requested By"),r.a.createElement("th",null,"Created At"),r.a.createElement("th",null,"Test Env"),r.a.createElement("th",null,"Test Path"),r.a.createElement("th",null,"Status"),r.a.createElement("th",null,"Details"))),r.a.createElement("tbody",null,e))))))}}]),a}(n.Component),v=a(16),f=a.n(v).a.create({baseURL:"http://127.0.0.1:8081/api/v1/"}),b=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e="failed";return"SUCCESS"===this.props.currentItem.status?e="succeed":"RUNNING"!==this.props.currentItem.status&&"CREATED"!==this.props.currentItem.status||(e="running"),r.a.createElement(p,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("a",{className:"btn btn-primary float-right",href:"#",onClick:this.props.backClicked.bind(this)},"Back"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("fieldset",null,r.a.createElement("legend",null,"Test details"),r.a.createElement("div",{className:"table-responsive"},r.a.createElement("table",{className:"table table-striped"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"title"},"ID"),r.a.createElement("td",null,this.props.currentItem.id)),r.a.createElement("tr",null,r.a.createElement("td",{className:"title"},"Requested by"),r.a.createElement("td",null,this.props.currentItem.requested_by)),r.a.createElement("tr",null,r.a.createElement("td",{className:"title"},"Env"),r.a.createElement("td",null,this.props.currentItem.env_name)),r.a.createElement("tr",null,r.a.createElement("td",{className:"title"},"Path"),r.a.createElement("td",null,this.props.currentItem.displayPath)),r.a.createElement("tr",{className:e},r.a.createElement("td",{className:"title"},"Status"),r.a.createElement("td",null,this.props.currentItem.status)),r.a.createElement("tr",null,r.a.createElement("td",{className:"title"},"Logs"),r.a.createElement("td",null,r.a.createElement("pre",null,r.a.createElement("code",{className:"python"},this.props.currentItem.logs)))))))))))}}]),a}(n.Component),N=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("fieldset",null,r.a.createElement("legend",null,"New request"),r.a.createElement("form",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-3 form-group"},r.a.createElement("input",{type:"text",className:"form-control",name:"requester",id:"requester",placeholder:"Requester",value:this.props.requester,onChange:this.props.requesterChanged.bind(this)}),r.a.createElement("p",{className:"error-message"},this.props.requesterError)),r.a.createElement("div",{className:"col-md-3 form-group"},r.a.createElement("select",{className:"form-control",name:"env_id",id:"env_id",placeholder:"Environment ID",value:this.props.env,onChange:this.props.envChanged.bind(this)},r.a.createElement("option",{value:"",defaultValue:!0}),this.props.assets.test_envs.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.name)}))),r.a.createElement("p",{className:"error-message"},this.props.envError)),r.a.createElement("div",{className:"col-md-4 form-group"},r.a.createElement("select",{className:"form-control",name:"test_path",id:"test_path",multiple:!0,placeholder:"Test Path",value:this.props.testPath,onChange:this.props.testPathChanged.bind(this)},r.a.createElement("option",{value:"",defaultValue:!0}),this.props.assets.available_paths.map((function(e){return r.a.createElement("option",{value:e.id,key:e.id},e.path)}))),r.a.createElement("p",{className:"error-message"},this.props.testPathError)),r.a.createElement("div",{className:"col-md-2"},r.a.createElement("input",{type:"button",className:"btn btn-primary",value:"Submit",disabled:""===this.props.testPath||""===this.props.requester||""===this.props.env,onClick:this.props.submitTest})))))))}}]),a}(n.Component),g=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12"},r.a.createElement("fieldset",null,r.a.createElement("legend",null,"New Test"),r.a.createElement("form",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-10 form-group"},r.a.createElement("input",{type:"file",className:"form-control-file","data-testid":"newTestFile",name:"newTestFile",id:"newTestFile",accept:".py",ref:this.props.fileInput}),r.a.createElement("p",{className:"error-message"},this.props.newTestFileError)),r.a.createElement("div",{className:"col-md-2"},"uploading"===this.props.status&&r.a.createElement("div",{class:"spinner-border text-primary",role:"status"}," ",r.a.createElement("span",{class:"sr-only"},"Loading...")),"idle"===this.props.status&&r.a.createElement("input",{"data-testid":"submitButton",type:"button",className:"btn btn-primary",value:"Submit",onClick:this.props.uploadTestFile})))))))}}]),a}(n.Component),y=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={assets:{test_envs:[],available_paths:[]},error:!1,items:[],detailsView:!1,itemID:null,currentItem:{},requesterError:"",envError:"",testPathError:"",requester:"",env:"",testPath:[],newTestFileStatus:"idle",newTestFile:"",newTestFileError:""},n.interval=null,n.getDisplayPath=function(e){var t="";return n.state.assets.available_paths.map((function(a){e.some((function(e){return e===a.id}))&&(t+=a.path+" ")})),t},n.refreshList=function(){f.get("test-run").then((function(e){var t=e.data;n.setState({items:t.map((function(e){return Object(i.a)({displayPath:n.getDisplayPath(e.path)},e)}))})})).catch((function(e){n.setState({error:!0})})),null!==n.state.itemID&&n.viewItemDetails(n.state.itemID)},n.uploadNewTestFile=function(){if(!(n.fileInput.current.files.length<1)){var e=new FormData;console.log(n.fileInput.current.files[0]),e.append("file",n.fileInput.current.files[0],n.fileInput.current.files[0].name),n.setState({newTestFileStatus:"uploading"}),f.post("test-file",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){alert("File uploaded successfully")})).catch((function(e){var t,a,n,r;(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.file[0])?alert(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.file[0]):alert("Error uploading file")})).finally((function(){n.setState({newTestFileStatus:"idle"}),n.updateAssets()}))}},n.submitTest=function(){f.post("test-run",{requested_by:n.state.requester,env:n.state.env,path:n.state.testPath}).then((function(e){n.setState({requester:"",env:"",testPath:""}),n.refreshList()})).catch((function(e){n.setState({requesterError:e.data.requested_by,envError:e.data.env,testPathError:e.data.path})}))},n.viewItemDetails=function(e){f.get("test-run/"+e).then((function(e){var t=e.data;t.displayPath=n.getDisplayPath(e.data.path),n.setState({currentItem:t})})).catch((function(e){n.setState({error:!0})})),n.setState({detailsView:!0,itemID:e})},n.backToListItems=function(){n.setState({detailsView:!1,itemID:null})},n.handleTestPathChanged=function(e){for(var t=e.target.options,a=[],r=0,s=t.length;r<s;r++)t[r].selected&&a.push(t[r].value);n.setState({testPath:a})},n.fileInput=r.a.createRef(),n}return Object(o.a)(a,[{key:"updateAssets",value:function(){var e=this;f.get("assets").then((function(t){e.setState({assets:t.data})})).catch((function(t){e.setState({error:!0})}))}},{key:"componentDidMount",value:function(){this.updateAssets(),this.interval=setInterval(this.refreshList,1e3),this.refreshList()}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this;return this.state.detailsView?r.a.createElement(b,{currentItem:this.state.currentItem,backClicked:this.backToListItems}):r.a.createElement(p,null,r.a.createElement(g,{fileInput:this.fileInput,newTestFileError:this.state.newTestFileError,uploadTestFile:function(t){return e.uploadNewTestFile()},status:this.state.newTestFileStatus}),r.a.createElement(N,{requester:this.state.requester,requesterError:this.state.requesterError,env:this.state.env,envError:this.state.envError,testPath:this.state.testPath,testPathError:this.state.testPathError,assets:this.state.assets,requesterChanged:function(t){var a;return e.setState({requester:null===(a=t.target.value)||void 0===a?void 0:a.toString()})},envChanged:function(t){var a;return e.setState({env:null===(a=t.target.value)||void 0===a?void 0:a.toString()})},testPathChanged:this.handleTestPathChanged,submitTest:this.submitTest}),r.a.createElement(E,{items:this.state.items,viewItemDetails:this.viewItemDetails}))}}]),a}(n.Component);var I=function(){return r.a.createElement("div",null,r.a.createElement(y,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[18,1,2]]]);
//# sourceMappingURL=main.f3b7456e.chunk.js.map